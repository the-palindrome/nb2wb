<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>nb2wb ‚Äî Medium Preview</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: charter, Georgia, Cambria, "Times New Roman", Times, serif;
      font-size: 20px;
      line-height: 1.8;
      color: #242424;
      max-width: 700px;
      margin: 0 auto;
      padding: 24px 20px 60px;
      background: #fff;
    }
    #toolbar {
      position: sticky;
      top: 0;
      z-index: 100;
      background: #1a8917;
      color: #fff;
      padding: 10px 20px;
      border-radius: 8px;
      margin-bottom: 28px;
      display: flex;
      align-items: center;
      gap: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    #toolbar button {
      background: #fff;
      color: #1a8917;
      border: none;
      padding: 8px 18px;
      font-size: 14px;
      font-weight: 600;
      border-radius: 20px;
      cursor: pointer;
      transition: background 0.15s;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }
    #toolbar button:hover { background: #e6f4e6; }
    #toolbar p { margin: 0; font-size: 13px; opacity: 0.9; }
    #content {
      background: #fff;
    }
    /* Image containers with inline copy buttons */
    .image-container {
      position: relative;
      margin: 0.5em 0;
    }
    .image-container img {
      max-width: 100%;
      height: auto;
      display: block;
      border-radius: 5px;
    }
    .copy-image-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: rgba(26, 137, 23, 0.9);
      color: #fff;
      border: none;
      padding: 6px 14px;
      font-size: 13px;
      font-weight: 600;
      border-radius: 16px;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }
    .image-container:hover .copy-image-btn { opacity: 1; }
    .copy-image-btn:hover { background: rgba(13, 95, 11, 0.95); }
    .copy-image-btn.copied { opacity: 1; background: #0d5f0b; }
    /* --- cell wrappers --- */
    .md-cell { margin-bottom: 1.4em; }
    .code-cell { margin: 1.6em 0; }
    /* --- images --- */
    img {
      max-width: 100%;
      height: auto;
      display: block;
    }
    .code-cell img { border-radius: 5px; }
    /* --- markdown typography --- */
    h1, h2, h3, h4, h5, h6 {
      font-family: sohne, "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-weight: 700;
      margin: 1.6em 0 0.4em;
      line-height: 1.3;
      color: #242424;
    }
    h1 { font-size: 2em; }
    h2 { font-size: 1.6em; }
    h3 { font-size: 1.3em; letter-spacing: -0.02em; }
    p { margin: 0 0 1.1em; }
    ul, ol { margin: 0 0 1.1em; padding-left: 1.8em; }
    li { margin-bottom: 0.3em; }
    blockquote {
      border-left: 3px solid #242424;
      margin: 1.2em 0;
      padding: 0.1em 1.2em;
      color: #242424;
      font-style: italic;
    }
    pre, code {
      font-family: Menlo, Monaco, "Courier New", Courier, monospace;
      font-size: 0.85em;
    }
    pre {
      background: #f2f2f2;
      padding: 1.2em;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      background: #f2f2f2;
      padding: 0.15em 0.4em;
      border-radius: 3px;
    }
    pre code {
      background: none;
      padding: 0;
    }
    table { border-collapse: collapse; width: 100%; margin-bottom: 1.2em; }
    th, td { border: 1px solid #e0e0e0; padding: 0.5em 0.8em; }
    th { background: #f9f9f9; font-weight: 600; }
    hr { border: none; border-top: 1px solid #e0e0e0; margin: 2em 0; }
    a { color: inherit; text-decoration: underline; }
    .nb2wb-footer {
      margin-top: 3em;
      padding-top: 1em;
      border-top: 1px solid #e6e6e6;
      text-align: center;
      font-size: 0.8em;
      color: #999;
    }
    .nb2wb-footer a { color: #999; text-decoration: none; }
    .nb2wb-footer a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <div id="toolbar">
    <button id="copy-btn" onclick="copyContent()">&#128203; Copy to clipboard</button>
    <p>Paste into Medium. If images are missing, hover each one to copy it.</p>
  </div>
  <div id="content">
<div class="md-cell"><h1>From Jupyter Notebook to Web</h1>
<p>This notebook demonstrates the <code>nb2wb</code> converter. It covers the three pillars<br />
of technical writing: prose, mathematics, and code.</p>
<p>Here's a nice image for illustration.</p>
<p><div class="image-container"><img src="images/img_1.png" alt="The parallelogram rule"><button class="copy-image-btn" type="button">Copy image</button></div></p></div>

<div class="md-cell"><h2>1  Inline LaTeX ‚Üí Unicode</h2>
<p>Inline expressions like <em>Œ±</em> + <em>Œ≤</em> = <em>Œ≥</em> or <em>E</em> = mc¬≤ are converted<br />
to Unicode so they render as plain readable text in Substack's editor.</p>
<p>Other examples: the golden ratio <em>œï</em> = (1+‚àö5)/(2), and Euler's<br />
identity <em>e</em><sup><em>i</em><em>œÄ</em></sup> + 1 = 0.</p></div>

<div class="md-cell"><h2>2  Display Math ‚Üí Image</h2>
<p>Block equations are rendered to crisp PNG images.</p>
<p>The quadratic formula:</p>
<pre><code class="language-latex">x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a} \label{eq:quadratic}
</code></pre>
<p>is rendered to </p>
<p><div class="image-container"><img src="images/img_2.png" alt="math"><button class="copy-image-btn" type="button">Copy image</button></div></p>
<p>You can render the equation references as <code>\\eqref{eq:quadratic}</code>, which renders like this: (1) gives both roots of ax¬≤ + bx + <em>c</em> = 0 simultaneously.</p>
<p>You can also use colors that are defined in the preamble. Bayes' theorem:</p>
<pre><code class="language-latex">P({\color{maizeCrayola} A} \mid {\color{blueGray} B}) = \frac{P({\color{blueGray} B} \mid {\color{maizeCrayola} A})\, P({\color{maizeCrayola} A})}{P({\color{blueGray} B})} \label{eq:bayes}
</code></pre>
<p>is rendered to </p>
<p><div class="image-container"><img src="images/img_3.png" alt="math"><button class="copy-image-btn" type="button">Copy image</button></div></p>
<p>A matrix equation:</p>
<pre><code class="language-latex">\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon} \label{eq:mtx}
</code></pre>
<p>is rendered to </p>
<p><div class="image-container"><img src="images/img_4.png" alt="math"><button class="copy-image-btn" type="button">Copy image</button></div></p>
<p>The Basel formula:</p>
<pre><code class="language-latex">\sum_{n=1}^{\infty} \frac{1}{n^2} = \frac{\pi^2}{6}
</code></pre>
<p>is rendered to </p>
<p><div class="image-container"><img src="images/img_5.png" alt="math"><button class="copy-image-btn" type="button">Copy image</button></div></p>
<p>Now, a complex multi-line example. The Gaussian integral, derived by switching to polar coordinates:</p>
<pre><code class="language-latex">\begin{align*}
I   &amp;= \int_{-\infty}^{\infty} e^{-x^2}\,dx \\[4pt]
I^2 &amp;= \int_{-\infty}^{\infty}\!\int_{-\infty}^{\infty} e^{-(x^2+y^2)}\,dx\,dy \\[4pt]
    &amp;= \int_0^{2\pi}\!\int_0^{\infty} e^{-r^2}\,r\,dr\,d\theta \\[4pt]
    &amp;= 2\pi \cdot \Bigl[-\tfrac{1}{2}e^{-r^2}\Bigr]_0^{\infty} \\[4pt]
    &amp;= \pi \\[4pt]
\therefore\quad I &amp;= \sqrt{\pi}
\end{align*}
</code></pre>
<p>is rendered to </p>
<p><div class="image-container"><img src="images/img_6.png" alt="math"><button class="copy-image-btn" type="button">Copy image</button></div></p></div>

<div class="md-cell"><h2>3  Code Blocks ‚Üí Image</h2>
<p>Code cells and their outputs are rendered as syntax-highlighted images,<br />
so formatting and colours are perfectly preserved.</p></div>

<div class="code-cell">
<div class="image-container"><img src="images/img_7.png" alt="code"><button class="copy-image-btn" type="button">Copy image</button></div>
</div>

<div class="code-cell">
<div class="image-container"><img src="images/img_8.png" alt="code"><button class="copy-image-btn" type="button">Copy image</button></div>
</div>

<div class="md-cell"><h2>4  Mixed: equation in context</h2>
<p>The softmax function maps a vector ùê≥ ‚àà ‚Ñù·¥∑ to a<br />
probability distribution:</p>
<p><div class="image-container"><img src="images/img_9.png" alt="math"><button class="copy-image-btn" type="button">Copy image</button></div></p>
<p>Here <em>j</em> = 1, ‚Ä¶, <em>K</em> indexes the classes.  Note that ‚àë‚±º <em>œÉ</em>‚±º = 1<br />
by construction.</p></div>

<div class="code-cell">
<div class="image-container"><img src="images/img_10.png" alt="code"><button class="copy-image-btn" type="button">Copy image</button></div>
</div>

<div class="md-cell"><h2>5  Figures</h2></div>

<div class="code-cell">
<div class="image-container"><img src="images/img_11.png" alt="code"><button class="copy-image-btn" type="button">Copy image</button></div>
<div class="image-container"><img src="images/img_12.png" alt="output"><button class="copy-image-btn" type="button">Copy image</button></div>
</div>

<div class="md-cell"><h2>6  Cell Tags</h2>
<p>Cells can be tagged to control what appears in the output.<br />
Tags are set via <strong>Edit ‚Üí Cell Metadata</strong> (or the cell toolbar) in Jupyter.</p>
<table>
<thead>
<tr>
<th>Tag</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hide-cell</code></td>
<td>Entire cell omitted (input + output)</td>
</tr>
<tr>
<td><code>hide-input</code></td>
<td>Source code hidden; output shown</td>
</tr>
<tr>
<td><code>hide-output</code></td>
<td>Output hidden; source code shown</td>
</tr>
</tbody>
</table></div>

<div class="md-cell"><p>The next cell is tagged <code>hide-input</code>: only its output is rendered.</p></div>

<div class="code-cell">
<div class="image-container"><img src="images/img_13.png" alt="code"><button class="copy-image-btn" type="button">Copy image</button></div>
</div>

<div class="md-cell"><p>The next cell is tagged <code>hide-output</code>: only its source code is rendered.</p></div>

<div class="code-cell">
<div class="image-container"><img src="images/img_14.png" alt="code"><button class="copy-image-btn" type="button">Copy image</button></div>
</div>

<div class="md-cell"><p>The setup cell at the top of this notebook is tagged <code>hide-cell</code> and is invisible in the output.</p></div>

<div class="md-cell"></div>
  <div class="nb2wb-footer">
    Made with <a href="https://github.com/the-palindrome/nb2wb">nb2wb</a>
  </div>
  </div><!-- #content -->

  <script>
    async function copyContent() {
      var btn = document.getElementById("copy-btn");
      try {
        var content = document.getElementById("content").cloneNode(true);

        // Unwrap .md-cell and .code-cell divs to avoid empty lines in Medium
        content.querySelectorAll(".md-cell, .code-cell").forEach(function(div) {
          var parent = div.parentNode;
          while (div.firstChild) {
            parent.insertBefore(div.firstChild, div);
          }
          parent.removeChild(div);
        });

        // Unwrap image containers but keep the <img> tags
        content.querySelectorAll(".image-container").forEach(function(container) {
          var img = container.querySelector("img");
          if (img) {
            container.replaceWith(img);
          }
        });

        // Remove footer
        var footer = content.querySelector(".nb2wb-footer");
        if (footer) footer.remove();

        var html = content.innerHTML;
        var blob = new Blob([html], { type: "text/html" });
        var item = new ClipboardItem({ "text/html": blob });
        await navigator.clipboard.write([item]);

        btn.textContent = "\u2713 Copied!";
        setTimeout(function() { btn.textContent = "\u{1F4CB} Copy to clipboard"; }, 2500);
      } catch (_) {
        var el = document.getElementById("content");
        var range = document.createRange();
        range.selectNode(el);
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand("copy");
        window.getSelection().removeAllRanges();
        btn.textContent = "\u2713 Copied!";
        setTimeout(function() { btn.textContent = "\u{1F4CB} Copy to clipboard"; }, 2500);
      }
    }

    // Copy a single image to clipboard
    async function copyImage(imgSrc, button) {
      try {
        var blob;
        if (imgSrc.startsWith("data:")) {
          var base64Data = imgSrc.split(",")[1];
          var mimeType = imgSrc.match(/data:([^;]+);/)[1];
          var byteChars = atob(base64Data);
          var bytes = new Uint8Array(byteChars.length);
          for (var i = 0; i < byteChars.length; i++) {
            bytes[i] = byteChars.charCodeAt(i);
          }
          blob = new Blob([bytes], { type: mimeType });
        } else {
          button.textContent = "Fetching\u2026";
          var response = await fetch(imgSrc);
          blob = await response.blob();
        }

        await navigator.clipboard.write([
          new ClipboardItem({ [blob.type]: blob })
        ]);

        button.textContent = "\u2713 Copied";
        button.classList.add("copied");
        setTimeout(function() {
          button.textContent = "Copy image";
          button.classList.remove("copied");
        }, 3000);
      } catch (err) {
        console.error("Failed to copy image:", err);
        button.textContent = "Failed";
        setTimeout(function() { button.textContent = "Copy image"; }, 3000);
      }
    }

    // Wire up copy-image buttons
    document.addEventListener("DOMContentLoaded", function() {
      document.querySelectorAll(".image-container").forEach(function(container) {
        var img = container.querySelector("img");
        var btn = container.querySelector(".copy-image-btn");
        if (img && btn) {
          btn.addEventListener("click", function() {
            copyImage(img.src, btn);
          });
        }
      });
    });
  </script>
</body>
</html>
